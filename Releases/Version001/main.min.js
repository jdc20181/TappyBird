$(function(){function t(){setTimeout(function(){setInterval(function(){1===gameState&&p()},1300)},2050)}function e(){(1===gameState||2===gameState)&&($bird.css("transform","rotate(-20deg)"),$bird.stop().animate({bottom:"+=60px"},200,function(){a(),$bird.css("transform","rotate(0deg)"),$bird.stop().animate({bottom:"-=60px"},300,"linear",function(){a(),i()})}))}function i(){birdPercent=parseInt($bird.css("bottom"))/$window.height(),totalFallTime=fallTime*birdPercent,$bird.stop().animate({bottom:"0"},totalFallTime,"linear"),$bird.css("transform","rotate(90deg)")}function o(){pipeId++,pipeTopHeight=Math.floor(Math.random()*($window.height()-250))+50,pipeBottomHeight=$window.height()-(pipeTopHeight+gapHeight),pipe='<div class="pipe" pipe-id="'+pipeId+'"><div style="height: '+pipeTopHeight+'px" class="topHalf"></div><div style="height:'+pipeBottomHeight+'px" class="bottomHalf"></div></div>',$window.append(pipe)}function p(){$(".window .pipe").first().remove()}function n(){$(".pipe").each(function(){$(this).animate({right:"+=160px"},1300,"linear")})}function a(){0===parseInt($bird.css("bottom"))&&r(),curPipe=$(".pipe:nth-of-type(4)"),curPipe.length>0&&(pipeTop=$(".pipe:nth-of-type(4) .topHalf"),pipeBottom=$(".pipe:nth-of-type(4) .bottomHalf"),$bird.offset().left+$bird.width()>=curPipe.offset().left&&$bird.offset().left<=curPipe.offset().left+curPipe.width()?($bird.offset().top<curPipe.offset().top+pipeTop.height()||$bird.offset().top+$bird.height()>curPipe.offset().top+pipeTop.height()+gapHeight)&&r():$bird.offset().left>=curPipe.offset().left+curPipe.width()&&$(".score").text(curPipe.attr("pipe-id")))}function r(){clearInterval(f),$(".pipe").stop(),i(),gameState=0,location.reload()}$window=$(".window"),$bird=$(".bird"),fallTime=1e3,gapHeight=120,gameState=2,pipeId=0;var f=(setInterval(function(){1===gameState&&(o(),n())},1300),setInterval(function(){1===gameState&&a()},10));$window.mousedown(function(){e(),2===gameState&&(gameState=1,t())}),$(window).keydown(function(i){32===i.keyCode&&(e(),i.preventDefault(),2===gameState&&(gameState=1,t()))})});
